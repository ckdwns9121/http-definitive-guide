# 2장 URL과 리소스

- 실생활의 리소스는 표준화된 이름으로 분류되며 이를 통해 리소스를 쉽게 공유할 수 있다.
  - 버스-노선번호, 계좌-계좌번호, 사람-주민등록번호 등
- URL은 인터넷의 리소스를 가리키는 표준 이름이며 리소스가 어디에 있고 어떻게 접근할 수 있는지 알려준다

<br>

## 2.1 인터넷의 리소스 탐색하기

- URL은 리소스가 어디에 있는지 설명해서 리소스를 식별한다.
- URL을 이용해 사람과 어플리케이션이 인터넷 상의 많은 리소스를 찾고 사용하며 공유할 수 있다.

`http://www.example.com/page/index.html`

- 스킴: `http`, 웹 클라이언트가 어떻게 접근하는지 알려준다.
- 호스트: `www.example.com`, 웹 클라이언트가 리소스가 어디에 호스팅 되어있는지 알려준다.
- 경로: `page/index.html`, 서버에 존재하는 리소스들 중 요청받은 리소스가 무엇인지 알려준다.

### 2.1.1 URL이 있기 전 암흑의 시대

- URL이 있기전에는 하나의 파일을 공유하기 위해 많은 과정을 거쳐야했다.
- URL을 사용하면 하나의 인터페이스를 통해 많은 리소스에 접근할 수 있다.
- **URL은 사용자와 브라우저에게 정보 찾는데 필요한 모든 것을 제공하며 리소스가 어디에 위치하고 어떻게 가져오는지 정의한다.**

<br>

## 2.2 URL 문법

- 리소스들은 스킴을 통해 접근할 수 있으며 URL 문법은 스킴에 따라 달라진다.
- 대부분의 URL 스킴의 문법은 9개의 컴포넌트로 나뉜다.
  - `<스킴>://<사용자이름>:<비밀번호>@<호스트>:<포트>/<경로>:<파라미터>?<질의>#<프래그먼트>`

### 2.2.1 스킴: 사용할 컴포넌트

- 스킴은 어떻게 리소스에 접근하는지 알려주는 중요한 정보다.
- 스킴 컴포넌트는 알파벳으로 시작하며 :문자로 구분한다. 대소문자를 가리지 않는다.

### 2.2.2 호스트와 포트

- 호스트 컴포넌트는 리소스를 가지고 있는 인터넷 상의 호스트 장비를 가리킨다. 호스트 명이나 IP 주소로 표현한다.
- 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킨다.

### 2.2.3 사용자 이름과 비밀번호

- FTP 프로토콜은 서버의 데이터에 접근을 허용하기 전 사용자 이름과 비밀번호를 요구한다.
- `@` 문자는 URL로부터 사용자 이름과 비밀번호 컴포넌트를 분리한다.
- `ftp://anonymouse:my_pwd@ftp.prep.ai.mit.edu/pub/gnu`

### 2.2.4 경로

- 경로 컴포넌트는 리소스가 서버에 어디에 있는지 알려준다.
- `/` 문자를 기준으로 경로조각으로 나뉘며 각 경로 조각은 자체만의 파라미터 컴포넌트를 가질 수 있다.

### 2.2.5 파라미터

- 파라미터 컴포넌트는 어플리케이션이 서버에 정확한 요청을 하기위해 필요한 입력 파라미터를 받는데 사용한다.
- 이름=값 쌍의 리스트로 `;` 문자로 구분해 URL에 기술한다.
- `http://www.example.com/public/index.html;name=true`
  - index.html 경로 조각은 값이 value인 name이란 파라미터를 갖는다.

### 2.2.6 질의 문자열

- 데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있다.
- 질의 컴포넌트는 게이트웨이 어플리케이션으로 전달된다.
- `http://.../check.cgi?item=111&color=blue`
  - 이 질의는 제품 번호가 12731이며 색깔이 파란 색인 재고를 확인한다.

### 2.2.7 프래그먼트

- 프래그먼트 컴포넌트는 리소스의 특정 부분을 가리키는데 사용한다.
- '#' 문자에 다음에 기술한다.
- 브라우저가 서버로부터 전체 리소스를 받은 후 프래그먼트를 사용해 사용자가 보고자하는 리소스의 일부를 보여준다.
- `http://.../tools.html#drills`
  - drills 라는 프래그먼트는 tools.html 웹 페이지의 일부를 가리킨다.

<br>

## 2.3 단축 URL

URL은 상대 URL과 절대 URL로 나뉜다.

### 2.3.1 상대 URL

- 상대 URL로 리소스 접근에 필요한 정보를 얻기 위해서는 기저(base) URL을 사용해야 한다.
- 상대 URL 문법에서는 스킴과 호스트 등 다른 컴포넌트들을 리소스의 기저 URL에서 알아낼 수 있다.
- `<a href="./example.html">` === `http://www.baseURL.com/example.html`
- 기저 URL과 상대 URL을 통해 새로운 절대 URL이 생성된다.

상대 URL을 절대 URL로 변환하는 과정은 다음과 같다.

![상대 URL을 절대 URL로 변환하는 과정](assets/2-1.png)

### 2.3.2 URl 확장

일부 브라우저들은 사용자가 URL을 입력하고 있는 동안 자동으로 URL을 확장한다. 이러한 확장 기능은 두 가지로 나뉜다.

> 이 부분은 6장에서 상세히 다룬다.

- 호스트명 확장: 주소 입력란에 naver를 입력하면 브라우저가 호스트 명에 자동으로 www와 com을 붙여 `www.naver.com`을 만든다.
- 히스토리 확장: 과거에 사용자가 방문한 URL의 기록 저장을 통해 확장한다.

<br>

## 2.4 안전하지 않은 문자

URL 설계자들은 다음과 같은 부분을 고려하며 URL을 설계했다.

- 모든 프로토콜이 데이터를 전송하기 위해 서로 다른 장치를 가지고 있으므로 어떤 프로토콜을 통해서든 안전하게 전송되어야 한다.
- 문자가 제거되는 일은 피하고 상재거으로 작고 안전한 알파벳 문자만 포함하도록 허락한다.
- 가독성이 있어야 한다.

추가적으로 URL에 안전한 이진 데이터나 알파벳을 제외한 문자가 포함되어야 하는 경우를 위해 이스케이프 기능을 추가해 안전한 문자로 인코딩 할 수 있게 설계되었다.

### 2.4.1 URL 문자 집합

- URL은 모든 프로토콜의 이름을 호환하기 위해 US-ASCII 인코딩을 사용한다
- URL이 특정 이진 데이터를 포함해야 하는 경우도 있으므로 이를 위해 이스케이프 문자열을 쓸 수 있게 설계되었다.

### 2.4.2 인코딩 체계

안전하지 않은 문자 % 기호로 시작해 ASCII 코드로 표현되는 두개의 16진수 숫자로 이루어진 이스케이프 문자로 바꾼다.

- 안전하지 않은 문자: 16진수 -> URL 상 이스케이프 문자
- ~: 126(0x7E) -> http://abc.com/%7Eindex.html
- 빈문자: 32(0x20) -> http://abc.com/more%20index.html
- %: 37(0x25) -> http://abc.com/more%25index.html

### 2.4.3 문자 제한

몇몇 문자는 URL 내 특별한 의미로 선점 및 제한되고 있다. [참고 링크](https://bluebreeze.co.kr/988)

<br>

## 2.5 스킴의 바다

일반적으로 사용되는 스킴에 대한 정보는 다음과 같다.

![스킴](assets/2-2.png)

![스킴](assets/2-3.png)

## 2.6 미래

URL의 단점은 리소스가 옮겨지면 URL을 더이상 사용할 수 없다는 것이다. 이러한 단점을 극복하기 위해 인터넷 기술 태스크 포스에서 URN 표준을 만들었다.

또한 지속 통합 자원 지시자(PURL)을 사용하면 URL로 URN의 기능을 제공할 수 있다.

- PURL은 리소스의 실제 URL 목록을 관리하고 추적하는 리소스 위치 중개 서버를 두고 리소스를 우회적으로 제공한다.
- 클라이언트는 영구 URL을 요청하고 영구 URL은 실제 URL로 연결해준다.

한동안 URN 방식이 활용 되었지만 주소 체계 표준화와 문법적인 문제등으로 인해 대중화되지 못했다.
